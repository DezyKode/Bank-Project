<div class="container1 ms-3 me-2" style="background-color: rgb(229, 229, 229);">
    <div style="background-color:rgb(229, 229, 229);">
        <h2 class="h4 text-primary">Tasks</h2>
        <button type="button" class="bg-secondary mb-3 rounded btn-s"><i class="fa-solid fa-plus"></i> Create Task</button>
    </div>
    <div class="row">
        <!-- To Do Column -->
        <div class="col-12 col-md-3">
            <h6 class="h6">TO DO</h6>
            <div style="overflow-y: auto; height: 82vh; width: 100%;">
                <div *ngFor="let task of toDoTasks">
                    <div class="card mb-3 hover-border" style="max-width: 18rem;" data-bs-toggle="modal" data-bs-target="#exampleModal" (click)="selectTask(task)" [ngClass]="{
                            'border-warning ': task.priority === 'Low',
                            'border-danger': task.priority === 'High',
                            'border-primary': task.priority === 'Medium'
                        }">
                        <div class="card-header cardHeader">
                            <div class="h6" style="width: 90%;">#{{task.id}}</div>
                            <span style="width: 10%;" [ngClass]="{
                                'text-warning': task.priority === 'Low',
                                'text-danger': task.priority === 'High',
                                'text-primary': task.priority === 'Medium'
                            }"><i class="fa-solid fa-circle-dot"></i></span>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title h5">{{task.task_title}}</h5>
                            <p class="card-text mb-3" style="text-align: end;">Assign To: {{task.assign_to}}</p>
                            <hr style="border: 0;border-top: 2px dashed black;margin: 20px 0;">
                            <p class="card-text"><i class="fa-regular fa-clock"></i> {{task.due_date}}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- In Progress Column -->
        <div class="col-12 col-md-3">
            <h6 class="h6">IN PROGRESS</h6>
            <div style="overflow-y: auto; height: 82vh;">
                <div *ngFor="let task of inProgressTasks">
                    <div class="card mb-3 hover-border" style="max-width: 18rem;" data-bs-toggle="modal" data-bs-target="#exampleModal" (click)="selectTask(task)" [ngClass]="{
                        'border-warning ': task.priority === 'Low',
                        'border-danger': task.priority === 'High',
                        'border-primary': task.priority === 'Medium'
                    }">
                        <div class="card-header cardHeader">
                            <div class="h6" style="width: 90%;">#{{task.id}}</div>
                            <span style="width: 10%;" [ngClass]="{
                                'text-warning': task.priority === 'Low',
                                'text-danger': task.priority === 'High',
                                'text-primary': task.priority === 'Medium'
                            }"><i class="fa-solid fa-circle-dot"></i></span>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title h5">{{task.task_title}}</h5>
                            <p class="card-text mb-3" style="text-align: end;">Assign To : {{task.assign_to}}</p>
                            <hr style="border: 0;border-top: 2px dashed black;margin: 20px 0;">
                            <p class="card-text"><i class="fa-regular fa-clock"></i> {{task.due_date}}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Completed Column -->
        <div class="col-12 col-md-3">
            <h6 class="h6">COMPLETED</h6>
            <div style="overflow-y: auto; height: 82vh;">
                <div *ngFor="let task of completedTasks">
                    <div class="card mb-3 hover-border" style="max-width: 18rem;" data-bs-toggle="modal" data-bs-target="#exampleModal" (click)="selectTask(task)" [ngClass]="{
                            'border-warning ': task.priority === 'Low',
                            'border-danger': task.priority === 'High',
                            'border-primary': task.priority === 'Medium'
                        }">
                        <div class="card-header cardHeader">
                            <div class="h6" style="width: 90%;">#{{task.id}}</div>
                            <span style="width: 10%;" [ngClass]="{
                                'text-warning': task.priority === 'Low',
                                'text-danger': task.priority === 'High',
                                'text-primary': task.priority === 'Medium'
                            }"><i class="fa-solid fa-circle-dot"></i></span>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title h5">{{task.task_title}}</h5>
                            <p class="card-text mb-3" style="text-align: end;">Assign To: {{task.assign_to}}</p>
                            <hr style="border: 0;border-top: 2px dashed black;margin: 20px 0;">
                            <p class="card-text"><i class="fa-regular fa-clock"></i> {{task.due_date}}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" style="font-family:Arial, Helvetica, sans-serif;" aria-hidden="true">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header bg-warning">
                        <div class="m-0 p-0">
                            <h4 style="font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif">#{{selectedTask?.id}} - {{selectedTask?.task_title}}</h4>
                            <div style="display: flex; flex-direction: row;">
                                <p>Create Date: <b>{{selectedTask?.create_date}}</b> | Due Date:
                                    <b>{{selectedTask?.due_date}}</b>
                                    |&nbsp;
                                </p>
                                <p [ngClass]="{
                                                'bg-orange': selectedTask?.priority === 'Low',
                                                'bg-danger': selectedTask?.priority === 'High',
                                                'bg-primary': selectedTask?.priority === 'Medium'
                                            }" class="ps-2 pe-2" style="border-radius: 10px;">
                                    <b>{{selectedTask?.priority}}</b>
                                </p>
                                &nbsp;
                                <p [ngClass]="{
                                                'bg-orange': selectedTask?.status=== 'InProgress',
                                                'bg-war': selectedTask?.status === 'ToDo',
                                                'bg-success': selectedTask?.status === 'Completed'
                                            }" class="ps-2 pe-2" style="border-radius: 10px;">
                                    <b>{{selectedTask?.status}}</b>
                                </p>
                                <p>&nbsp; | Assign To: <b>{{selectedTask?.assign_to}}</b></p>
                            </div>
                        </div>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="modalBody">
                            <div class="container text-center topBox">
                                <div class="row">
                                    <div class="col-md-4 text-start">
                                        <h6 class="h6 fw-semibold">DESCRIPTION</h6>
                                        <p>{{selectedTask?.task_description}}</p>
                                    </div>
                                    <div class="col-md-4 offset-md-4 text-end"><i class="fa-sharp-duotone fa-regular fa-circle-check text-success"></i></div>
                                </div>
                            </div>
                            <hr style="border: 0;border-top: 2px dashed black;margin: 20px 0;">
                            <div class="bottomBox">
                                <div class="row align-items-start">
                                    <div class="col">
                                        <p>Create Date : <br> <b>{{selectedTask?.create_date}}</b></p>
                                    </div>
                                    <div class="col">
                                        <p>Completed Date: <br> <b>{{selectedTask?.completed_date}}</b></p>
                                    </div>
                                    <div class="col">
                                        <p>Priority: <br>
                                            <b class="ps-2 pe-2" [ngClass]="priorityClass" style="border-radius: 10px;">
                                                <select [(ngModel)]="priority" (change)="onPriorityChange()"
                                                    style="background: none; border: none; outline: none;">
                                                    <option *ngFor="let option of ['Low', 'High', 'Medium']" [value]="option">{{option}}</option>
                                                </select>
                                            </b>
                                        </p>
                                    </div>
                                    <div class="col">
                                        <p>Status: <br>
                                            <b class="ps-2 pe-2" [ngClass]="statusClass" style="border-radius: 10px;">
                                                <select [(ngModel)]="status" (change)="onStatusChange()"
                                                    style="background: none; border: none; outline: none;">
                                                    <option *ngFor="let option of ['Completed', 'InProgress', 'ToDo']" [value]="option">{{option}}</option>
                                                </select>
                                            </b>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
